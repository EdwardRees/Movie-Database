# Movie-Database

CS 333 Movie Database

## Dependencies

- PostgresSQL
- python3
- wget
- python3-wget

## Instructions to run

### Manual Running

1. Check if `wget`, `python3`, `pip3`, and the `wget` module in `pip3`
2. Enter the `util` folder and run the `files.py` script with `python3 files.py`<sup>[1]</sup>
3. Once the `files.py` finishes running, create a database in postgres called `moviesdb` either with `createdb moviesdb` or `psql -U postgres -c "CREATE DATABASE moviesdb"`.
4. Once the database is created, run the `db.sql` script in postgres with the command `psql moviesdb < db.sql`. <sup>[2]</sup>

### Automated Running

- If the user is on Mac OS, they can run the `run.sh` script after changing the permissions to executable with `chmod +x run.sh`. This will automatically check for the dependencies - letting the user know if a dependency is missing or not, then run the python files. Afterwards, it'll check if the `moviesdb` database exists, if it doesn't, it will create the database. It will then run the `db.sql` script using `psql moviesdb < db.sql`.

### Footnotes

<sup>[1]</sup> This will download the `movies.zip` file, store it in a `movies` folder, which will be created if it doesn't already exist, then `unzip` the file. Once this is completed, it will parse the `movies.txt` file, creating the files `movies.txt`, `genres.txt`, and `has_genres.txt`, placing them in the `out` folder - which would also be created if it doesn't already exist. The program will then read the `tags.txt` file, parse the contents, before creating a `tags.txt` file in the `out` folder. Lastly, it will read the `ratings.txt` file, parsing and creating a `ratings.txt` file placed in the `out` folder. While the `tags` and `ratings` are being parsed, a `Users` set is being generated, which eventually creates the `users.txt` file, keeping track of the `user id`s, which is also stored in the `out` folder.

<sup>[2]</sup> The `db.sql` file will drop the tables if they already exist, before reading the files in `out` and populating the tables from there.

## Folders and Files

- diagrams folder: Contains the E/R diagrams
- writeups folder: Contains the pdf writeups from Google Drive
- run.sh: Bash Script to run all code
- sql.sh: Simple Bash Script to run sql code
- db.sql: SQL Code to construct the database, parsing from the out folder generated by the python code
- constants.py: Python code containing constants used
- download.py: Python code to download the movies.zip file, moving the zip file to a `movies` folder created, unzipping the file in the `movies` folder.
- files.py: Python code containing primary file parsing executions, calls other python functions
- genres.py: Python code to parse out the genres from the `movies.txt` file, creating the `genres.txt` and `has_genre.txt` files in the `out` folder
- movies.py: Python code to parse out the movies from the `movies.txt` file, creating the `movies.txt` file in the `out` folder
- ratings.py: Python code to parse out the ratings and create the `ratings.txt` file in the `out` folder
- tags.py: Python code to parse out the tags and create the `tags.txt` file in the `out` folder
- users.py: Python code to parse out the user ids and create the `users.txt` file in the `out` folder
- util.py: Python code to read a file and other simple utility functions
